<ion-navbar>
  <ion-grid>
    <ion-row>
      <ion-col col-12 class="flex-display">
        <ion-title *ngIf="anyNewItems == 'true'">New Items</ion-title>
        <button *ngIf="anyNewItems == 'true'"
          (click)="closeItemsShwon()"
          class="close"
          menuClose="right">&times;</button>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-navbar>
<ion-content class="activities" scroll="false" *ngIf="anyNewItems == 'false'">
  <ion-refresher *ngIf="checkUserPointer" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content pullingIcon="arrow-dropdown"
      pullingText="Pull to refresh"
      refreshingSpinner="circles">
    </ion-refresher-content>
  </ion-refresher>
  <ion-grid>
    <ion-row class="score-board">
      <ion-col col-12>
        <img class="dashboard-logo" src="./assets/img/main/logo01.svg" (click)="refreshPage()" />
      </ion-col>
      <ion-col col-12>
        <ul class="dashboard-data">
          <li col-4>
            <p class="title">Bookings</p>
            <p [ngClass]="sameFontSize == true ? 'font-20pt': 'font-22pt'" class="number" [style.height.px]="47.31">
              {{ bookedEventsCount || '' }}
            </p>
            <p class="link" (click)="openEvent()">Browse Events</p>
          </li>
          <li col-4>
            <p class="title">Points</p>
            <p [ngClass]="userExperiencePoint >= 100000 ? 'font-20pt': 'font-22pt'" class="number" [style.height.px]="47.31">
              {{ characterCurrentExperience || '' }}
            </p>
            <p class="link" (click)="openLeaderboard()">Leaderboard</p>
          </li>
          <li col-4>
            <p class="title">Grade</p>
            <p [style.height.px]="47.31" class="number user-grade">
              <ion-badge *ngIf="!button_show" [ngClass]="AverageScore[i] > 2 ? 'better-grade-color' : 'worse-grade-color'">
                {{ finalAverageScoreShow }}
              </ion-badge>
              <button block *ngIf="button_show">
                <i class="fa fa-clock-o" aria-hidden="true"></i>
              </button>
            </p>
            <p class="link" (click)="whatsThis()">What's this?</p>
          </li>
        </ul>
      </ion-col>
    </ion-row>
    <ion-row class="activity-list">
      <ion-col>
        <div class="activity-error" *ngIf="returnError == true">
          <p>
            {{ activitiesLoadingErr }}
          </p>
        </div>
        <div *ngFor="let activity of activities; let i = index">
          <div *ngIf="activity.Activity.is_locked == false" class="unlocked bg-color-{{i}}">
            <div (click)="goToDetail(activity)" class="line-break">
              <p col-7 class="activity-title">{{ activity.Activity.name }}</p>
              <p col-3 class="ticks"> 
                <!-- This is hardcode just for display different numbers, coz ngClass add dynamic variable does not work -->
                <span *ngIf="i == 0">
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-6': changeColor[i][0], 'fa-circle-thin': !changeColor[i][0] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-6': changeColor[i][1], 'fa-circle-thin': !changeColor[i][1] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-6': changeColor[i][2], 'fa-circle-thin': !changeColor[i][2] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-6': changeColor[i][3], 'fa-circle-thin': !changeColor[i][3] }" aria-hidden="true"></i>
                </span>
                <span *ngIf="i == 1">
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-4': changeColor[i][0], 'fa-circle-thin': !changeColor[i][0] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-4': changeColor[i][1], 'fa-circle-thin': !changeColor[i][1] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-4': changeColor[i][2], 'fa-circle-thin': !changeColor[i][2] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-4': changeColor[i][3], 'fa-circle-thin': !changeColor[i][3] }" aria-hidden="true"></i>
                </span>
                <span *ngIf="i == 2">
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-1': changeColor[i][0], 'fa-circle-thin': !changeColor[i][0] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-1': changeColor[i][1], 'fa-circle-thin': !changeColor[i][1] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-1': changeColor[i][2], 'fa-circle-thin': !changeColor[i][2] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-1': changeColor[i][3], 'fa-circle-thin': !changeColor[i][3] }" aria-hidden="true"></i>
                </span>
                <span *ngIf="i == 3">
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-2': changeColor[i][0], 'fa-circle-thin': !changeColor[i][0] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-2': changeColor[i][1], 'fa-circle-thin': !changeColor[i][1] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-2': changeColor[i][2], 'fa-circle-thin': !changeColor[i][2] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-2': changeColor[i][3], 'fa-circle-thin': !changeColor[i][3] }" aria-hidden="true"></i>
                </span>
                <span *ngIf="i == 4">
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-0': changeColor[i][0], 'fa-circle-thin': !changeColor[i][0] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-0': changeColor[i][1], 'fa-circle-thin': !changeColor[i][1] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-0': changeColor[i][2], 'fa-circle-thin': !changeColor[i][2] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-0': changeColor[i][3], 'fa-circle-thin': !changeColor[i][3] }" aria-hidden="true"></i>
                </span>
                <span *ngIf="i == 5">
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-3': changeColor[i][0], 'fa-circle-thin': !changeColor[i][0] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-3': changeColor[i][1], 'fa-circle-thin': !changeColor[i][1] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-3': changeColor[i][2], 'fa-circle-thin': !changeColor[i][2] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-3': changeColor[i][3], 'fa-circle-thin': !changeColor[i][3] }" aria-hidden="true"></i>
                </span>
                <span *ngIf="i == 6">
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-5': changeColor[i][0], 'fa-circle-thin': !changeColor[i][0] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-5': changeColor[i][1], 'fa-circle-thin': !changeColor[i][1] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-5': changeColor[i][2], 'fa-circle-thin': !changeColor[i][2] }" aria-hidden="true"></i>
                  <i class="fa icon-color-default" [ngClass]="{'fa-check-circle-o icon-color-5': changeColor[i][3], 'fa-circle-thin': !changeColor[i][3] }" aria-hidden="true"></i>
                </span>
              </p>
              <p col-2 class="assessment-score">
                <button block *ngIf="!show_score_act[i]" >
                  <i class="fa fa-clock-o" aria-hidden="true"></i>
                </button>
                <ion-badge *ngIf="show_score_act[i]" [ngClass]="AverageScore[i] > 2 ? 'better-grade-color' : 'worse-grade-color'">
                  {{ AverageScore[i] }}
                </ion-badge>
              </p>
            </div>
          </div>
          <div *ngIf="activity.Activity.is_locked == true" class="locked">
            <i class="fa fa-lock" aria-hidden="true"></i>
            <p (click)="goToPopup(activity.Activity.unlock_id)" class="line-break">
              {{ activity.Activity.name }}
            </p>
          </div>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
<ion-content *ngIf="anyNewItems == 'true'" id="itemsPopup" class="items-popup">
  <ion-list class="items-popup-data">
    <ion-grid>
      <ion-row>
        <ion-col>
          <ion-slides pager="true" class="tutorial-slides" *ngFor="let item of newItemsData">
            <ion-slide>
              <img *ngIf="item.meta !== null" class="item-popup-img" src="{{ item.meta.img }}" alt="item"/>
              <img *ngIf="item.meta === null || item.meta.img === null"
                class="item-popup-img"
                src="https://www.filepicker.io/api/file/ySw7HfSQbOmkVdowHrag" alt="item"/>
              <p class="item-popup-text">
                {{ item.name }} <span> x{{ item.count[0].count }}</span>
              </p>
            </ion-slide>
          </ion-slides>
          <button class="general-circle-btn" (click)="closeItemsShwon()">OK</button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-list>
</ion-content>
